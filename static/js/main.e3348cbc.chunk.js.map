{"version":3,"sources":["Login/Login.tsx","Profile/Graph.tsx","Profile/MetricTable.tsx","Profile/Profile.tsx","App/App.tsx","App/eth.png","index.tsx"],"names":["web3","undefined","Login","onLoggedIn","useState","loading","setLoading","handleAuthenticate","publicAddress","signature","fetch","process","body","JSON","stringify","headers","method","then","response","json","handleSignMessage","a","nonce","eth","personal","sign","Error","handleSignup","handleClick","window","ethereum","alert","enable","Web3","getCoinbase","coinbase","toLowerCase","users","length","catch","err","className","onClick","Graph","chartdata","data","rebate","Number","toFixed","i","push","price","state","options","chart","height","toolbar","show","zoom","enabled","colors","dataLabels","markers","size","style","fill","type","gradient","shadeIntensity","opacityFrom","opacityTo","stops","grid","borderColor","strokeDashArray","stroke","yaxis","lines","series","name","useStyles","makeStyles","table","minWidth","MetricTable","tabledata","classes","TableContainer","component","Paper","Table","aria-label","TableHead","TableRow","TableCell","align","TableBody","map","row","index","scope","ts","sender","myContract","Profile","auth","onLoggedOut","user","username","setState","loadingGraph","totalUpdateCount","setTotalUpdateCount","currentETHUSDT","setCurrentETHUSDT","priceArray","setPriceArray","ourOracle","useEffect","accessToken","id","jwtDecode","payload","Authorization","Contract","Abi","web3init","drawMetrics","methods","updateCount","call","error","res","console","log","getTableData","ETHUSD","count","splice","updatePrice","getGasPrice","from","gasPrice","gas","value","send","htmlFor","onChange","target","disabled","marginLeft","marginBottom","marginTop","LS_KEY","App","ls","localStorage","getItem","parse","src","alt","removeItem","setItem","dotEnvConfig","path","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.e3348cbc.chunk.js","sourcesContent":["import './Login.css';\n\nimport React, { useState } from 'react';\nimport Web3 from 'web3';\n\nimport { Auth } from '../types';\n\ninterface Props {\n\tonLoggedIn: (auth: Auth) => void;\n}\n\nlet web3: Web3 | undefined = undefined; // Will hold the web3 instance\n\nexport const Login = ({ onLoggedIn }: Props): JSX.Element => {\n\tconst [loading, setLoading] = useState(false); // Loading button state\n\n\tconst handleAuthenticate = ({\n\t\tpublicAddress,\n\t\tsignature,\n\t}: {\n\t\tpublicAddress: string;\n\t\tsignature: string;\n\t}) =>\n\t\tfetch(`${process.env.REACT_APP_BACKEND_URL}/auth`, {\n\t\t\tbody: JSON.stringify({ publicAddress, signature }),\n\t\t\theaders: {\n\t\t\t\t'Content-Type': 'application/json',\n\t\t\t},\n\t\t\tmethod: 'POST',\n\t\t}).then((response) => response.json());\n\n\tconst handleSignMessage = async ({\n\t\tpublicAddress,\n\t\tnonce,\n\t}: {\n\t\tpublicAddress: string;\n\t\tnonce: string;\n\t}) => {\n\t\ttry {\n\t\t\tconst signature = await web3!.eth.personal.sign(\n\t\t\t\t`I am signing my one-time nonce: ${nonce}`,\n\t\t\t\tpublicAddress,\n\t\t\t\t'' // MetaMask will ignore the password argument here\n\t\t\t);\n\n\t\t\treturn { publicAddress, signature };\n\t\t} catch (err) {\n\t\t\tthrow new Error(\n\t\t\t\t'You need to sign the message to be able to log in.'\n\t\t\t);\n\t\t}\n\t};\n\n\tconst handleSignup = (publicAddress: string) =>\n\t\tfetch(`${process.env.REACT_APP_BACKEND_URL}/users`, {\n\t\t\tbody: JSON.stringify({ publicAddress }),\n\t\t\theaders: {\n\t\t\t\t'Content-Type': 'application/json',\n\t\t\t},\n\t\t\tmethod: 'POST',\n\t\t}).then((response) => response.json());\n\n\tconst handleClick = async () => {\n\t\t// Check if MetaMask is installed\n\t\tif (!(window as any).ethereum) {\n\t\t\twindow.alert('Please install MetaMask first.');\n\t\t\treturn;\n\t\t}\n\n\t\tif (!web3) {\n\t\t\ttry {\n\t\t\t\t// Request account access if needed\n\t\t\t\tawait (window as any).ethereum.enable();\n\n\t\t\t\t// We don't know window.web3 version, so we use our own instance of Web3\n\t\t\t\t// with the injected provider given by MetaMask\n\t\t\t\tweb3 = new Web3((window as any).ethereum);\n\t\t\t} catch (error) {\n\t\t\t\twindow.alert('You need to allow MetaMask.');\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tconst coinbase = await web3.eth.getCoinbase();\n\t\tif (!coinbase) {\n\t\t\twindow.alert('Please activate MetaMask first.');\n\t\t\treturn;\n\t\t}\n\n\t\tconst publicAddress = coinbase.toLowerCase();\n\t\tsetLoading(true);\n\n\t\t// Look if user with current publicAddress is already present on backend\n\t\tfetch(\n\t\t\t`${process.env.REACT_APP_BACKEND_URL}/users?publicAddress=${publicAddress}`\n\t\t)\n\t\t\t.then((response) => response.json())\n\t\t\t// If yes, retrieve it. If no, create it.\n\t\t\t.then((users) =>\n\t\t\t\tusers.length ? users[0] : handleSignup(publicAddress)\n\t\t\t)\n\t\t\t// Popup MetaMask confirmation modal to sign message\n\t\t\t.then(handleSignMessage)\n\t\t\t// Send signature to backend on the /auth route\n\t\t\t.then(handleAuthenticate)\n\t\t\t// Pass accessToken back to parent component (to save it in localStorage)\n\t\t\t.then(onLoggedIn)\n\t\t\t.catch((err) => {\n\t\t\t\twindow.alert(err);\n\t\t\t\tsetLoading(false);\n\t\t\t});\n\t};\n\n\treturn (\n\t\t<div>\n\t\t\t<p>\n\t\t\t\tPlease select your login method.\n\t\t\t\t<br />\n\t\t\t\tFor the purpose of this demo, only MetaMask login is\n\t\t\t\timplemented.\n\t\t\t</p>\n\t\t\t<button className=\"Login-button Login-mm\" onClick={handleClick}>\n\t\t\t\t{loading ? 'Loading...' : 'Login with MetaMask'}\n\t\t\t</button>\n\t\t</div>\n\t);\n};\n","import React, { Component } from 'react';\r\nimport Chart from \"react-apexcharts\";\r\nimport { PriceItem } from '../types';\r\ninterface Props {\r\n\tchartdata: PriceItem[]\r\n}\r\nexport const Graph = ({ chartdata }: Props): JSX.Element => {\r\n    \r\n    const data = [];\r\n    let rebate = 0.5;\r\n    rebate = Number(rebate.toFixed(2));\r\n    \r\n    for(let i = 0; i < chartdata.length; i+=1) {                            \r\n        // data.push([chartdata[i].ts, chartdata[i].price]);\r\n        data.push([i, chartdata[i].price]);\r\n    }\r\n    const state = {\r\n        options: {\r\n            chart: {\r\n                // type: 'area',\r\n                height: 288,\r\n                toolbar: {\r\n                    show: false,\r\n                },\r\n                zoom: {\r\n                    enabled: false\r\n                },                    \r\n            },\r\n            // legend: {                    \r\n            //     position: 'top',\r\n            //     horizontalAlign: 'right',\r\n            //     show: true,\r\n            // },\r\n            colors: ['#6435c9'],\r\n            dataLabels: {\r\n                enabled: false\r\n            },\r\n            markers: {\r\n                size: 0,\r\n                style: 'hollow',\r\n            },\r\n            // xaxis: {\r\n            //     type: \"datetime\",\r\n            //     min:0,\r\n            //     labels: {\r\n            //         formatter: function (value: number) {\r\n            //             return value;\r\n            //         }\r\n            //     }\r\n            // },\r\n            // // tooltip: {\r\n            // //     custom: function({series, seriesIndex, dataPointIndex, w}) {\r\n            // //         return '<div class=\"arrow_box\">' +\r\n            // //         '<div>' + 'Day' + \":\" + dataPointIndex  + '</div>' +\r\n            // //         '<div>' + \"+\" + series[seriesIndex][dataPointIndex] + \"   GDP\" + \"(+\" + (series[seriesIndex][dataPointIndex] / 10).toFixed(1) + \"%)\" + '</div>' +\r\n            // //         '</div>'\r\n            // //     }\r\n            // // },\r\n            fill: {\r\n                type: 'gradient',\r\n                gradient: {\r\n                    shadeIntensity: 1,\r\n                    opacityFrom: 0.7,\r\n                    opacityTo: 0.9,\r\n                    stops: [0, 100]\r\n                }\r\n            },\r\n            // stroke: {\r\n            //     show: true,\r\n            //     curve: 'straight',\r\n            //     width: 1,\r\n            // },\r\n            grid: {\r\n                borderColor: '#111',\r\n                strokeDashArray: 7,\r\n                stroke: 1,\r\n                yaxis: {                            \r\n                    lines: {\r\n                        show: true,\r\n                    }\r\n                },\r\n            },\r\n        },\r\n        series: [{\r\n            name: 'ETHUSDT',\r\n            data: data\r\n        }\r\n        ],\r\n    };\r\n\r\n    return (\r\n        <div>\r\n            <Chart\r\n                options={state.options}\r\n                series={state.series}\r\n                type=\"area\"\r\n                height=\"300px\"\r\n            />\r\n        </div>\r\n    );    \r\n}\r\n","import React from 'react';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport Table from '@material-ui/core/Table';\r\nimport TableBody from '@material-ui/core/TableBody';\r\nimport TableCell from '@material-ui/core/TableCell';\r\nimport TableContainer from '@material-ui/core/TableContainer';\r\nimport TableHead from '@material-ui/core/TableHead';\r\nimport TableRow from '@material-ui/core/TableRow';\r\nimport Paper from '@material-ui/core/Paper';\r\nimport { PriceItem } from '../types';\r\n\r\nconst useStyles = makeStyles({\r\n  table: {\r\n    minWidth: 650,\r\n  },\r\n});\r\ninterface Props {\r\n\ttabledata: PriceItem[]\r\n}\r\nfunction createData(name: string, calories: number, fat: number, carbs: number, protein: number) {\r\n  return { name, calories, fat, carbs, protein };\r\n}\r\n\r\n\r\nexport default function MetricTable({ tabledata }: Props) {\r\n  const classes = useStyles();\r\n  return (\r\n    <TableContainer component={Paper}>\r\n      <Table className={classes.table} aria-label=\"simple table\">\r\n        <TableHead>\r\n          <TableRow>\r\n            <TableCell>No</TableCell>\r\n            <TableCell>TimeStamp</TableCell>\r\n            <TableCell align=\"right\">ETHUSDT</TableCell>\r\n            <TableCell align=\"right\">Sender</TableCell>            \r\n          </TableRow>\r\n        </TableHead>\r\n        <TableBody>\r\n          {tabledata.map((row, index) => (\r\n            <TableRow key={row.ts}>\r\n              <TableCell>{index}</TableCell>\r\n              <TableCell component=\"th\" scope=\"row\">\r\n                {row.ts}\r\n              </TableCell>\r\n              <TableCell align=\"right\">{row.price}</TableCell>\r\n              <TableCell align=\"right\">{row.sender}</TableCell>\r\n            </TableRow>\r\n          ))}\r\n        </TableBody>\r\n      </Table>\r\n    </TableContainer>\r\n  );\r\n}\r\n","import './Profile.css';\n\nimport jwtDecode from 'jwt-decode';\nimport React, { useState, useEffect } from 'react';\nimport Blockies from 'react-blockies';\nimport {Contract} from 'web3-eth-contract';\nimport { Auth, PriceItem } from '../types';\nimport Web3 from 'web3';\nimport { AbiItem } from 'web3-utils';\nimport Abi from '../abi.json';\nimport { Graph } from './Graph';\nimport MetricTable from './MetricTable';\n\nlet web3: Web3 | undefined = undefined;let myContract: Contract | undefined = undefined; // Will hold the web3 instance\n\ninterface Props {\n\tauth: Auth;\n\tonLoggedOut: () => void;\n}\n\ninterface State {\n\tloading: boolean;\n\tuser?: {\n\t\tid: number;\n\t\tusername: string;\n\t};\n\tusername: string;\n}\n\ninterface JwtDecoded {\n\tpayload: {\n\t\tid: string;\n\t\tpublicAddress: string;\n\t};\n}\n\nexport const Profile = ({ auth, onLoggedOut }: Props): JSX.Element => {\n\tconst [state, setState] = useState<State>({\n\t\tloading: false,\n\t\tuser: undefined,\n\t\tusername: '',\t\t\n\t});\n\tconst [loadingGraph, setLoadingGraph] = useState(false);\n\tconst [totalUpdateCount, setTotalUpdateCount] = useState(0);\n\tconst [currentETHUSDT, setCurrentETHUSDT] = useState(0);\n\tconst [priceArray, setPriceArray] = useState<PriceItem[]>([]);\n\tconst ourOracle = \"0xA9B7bFAA96210637438C4A89D5c2F5b343062886\";\n\tuseEffect(() => {\n\t\tconst { accessToken } = auth;\n\t\tconst {\n\t\t\tpayload: { id },\n\t\t} = jwtDecode<JwtDecoded>(accessToken);\n\n\t\tfetch(`${process.env.REACT_APP_BACKEND_URL}/users/${id}`, {\n\t\t\theaders: {\n\t\t\t\tAuthorization: `Bearer ${accessToken}`,\n\t\t\t},\n\t\t})\n\t\t\t.then((response) => response.json())\n\t\t\t.then((user) => setState({ ...state, user }))\n\t\t\t.catch(window.alert);\n\t}, []);\n\n\tconst handleChange = ({\n\t\ttarget: { value },\n\t}: React.ChangeEvent<HTMLInputElement>) => {\n\t\tsetState({ ...state, username: value });\n\t};\n\n\tconst handleSubmit = () => {\n\t\tconst { accessToken } = auth;\n\t\tconst { user, username } = state;\n\n\t\tsetState({ ...state, loading: true });\n\n\t\tif (!user) {\n\t\t\twindow.alert(\n\t\t\t\t'The user id has not been fetched yet. Please try again in 5 seconds.'\n\t\t\t);\n\t\t\treturn;\n\t\t}\n\n\t\tfetch(`${process.env.REACT_APP_BACKEND_URL}/users/${user.id}`, {\n\t\t\tbody: JSON.stringify({ username }),\n\t\t\theaders: {\n\t\t\t\tAuthorization: `Bearer ${accessToken}`,\n\t\t\t\t'Content-Type': 'application/json',\n\t\t\t},\n\t\t\tmethod: 'PATCH',\n\t\t})\n\t\t\t.then((response) => response.json())\n\t\t\t.then((user) => setState({ ...state, loading: false, user }))\n\t\t\t.catch((err) => {\n\t\t\t\twindow.alert(err);\n\t\t\t\tsetState({ ...state, loading: false });\n\t\t\t});\n\t};\n\n\tconst { accessToken } = auth;\n\n\tconst {\n\t\tpayload: { publicAddress },\n\t} = jwtDecode<JwtDecoded>(accessToken);\n\n\tconst { loading, user } = state;\n\tconst username = user && user.username;\n\t\n\t//init\n\tconst web3init = async () => {\n\t\t// Check if MetaMask is installed\n\t\tif (!(window as any).ethereum) {\n\t\t\twindow.alert('Please install MetaMask first.');\n\t\t\treturn;\n\t\t}\n\n\t\tif (!web3) {\n\t\t\ttry {\n\t\t\t\t// Request account access if needed\n\t\t\t\tawait (window as any).ethereum.enable();\n\n\t\t\t\t// We don't know window.web3 version, so we use our own instance of Web3\n\t\t\t\t// with the injected provider given by MetaMask\n\t\t\t\tweb3 = new Web3((window as any).ethereum);\n\t\t\t} catch (error) {\n\t\t\t\twindow.alert('You need to allow MetaMask.');\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tconst coinbase = await web3.eth.getCoinbase();\n\t\tif (!coinbase) {\n\t\t\twindow.alert('Please activate MetaMask first.');\n\t\t\treturn;\n\t\t}\n\n\t\t//get metrics from Web3\n\t\tmyContract = new web3.eth.Contract(\n\t\t\tAbi as AbiItem[],\n\t\t\tourOracle\n\t\t);\t\t\n\t};\n\n\t// //initialize\n\tweb3init();\n\n\tconst drawMetrics = async () => {\n\t\tconst res = await myContract!.methods\n\t\t\t.updateCount()\n\t\t\t.call({}, function (error: null, res: any) {\n\t\t\t\tif (error != null) {\n\t\t\t\t\tconsole.log(error);\n\t\t\t\t\treturn;\n\t\t\t\t}\t\t\t\t\n\t\t\t});\n\t\tsetTotalUpdateCount(Number(res));\n\t\tawait getTableData(Number(res));\t\t\n\t\t\n\t\tmyContract!.methods\n\t\t\t.ETHUSD()\n\t\t\t.call({}, function (error: null, res: any) {\n\t\t\t\tif (error != null) {\n\t\t\t\t\tconsole.log(error);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tsetCurrentETHUSDT(Number(res));\n\t\t\t});\n\t\t\t\n\t}\n\tconst getTableData = async (count: number) => {\n\t\t//Clear array\n\t\tpriceArray.splice(0,priceArray.length);\n\n\t\tfor(let i = 0; i<count; i++){\t\t\t\n\t\t\tconst res = await myContract!.methods\n\t\t\t\t.priceArray(i)\n\t\t\t\t.call();\n\t\t\tpriceArray.push({ts: res.ts, price: res.price, sender: res.sender});\t\t\t\n\t\t}\n\t\tsetPriceArray(priceArray);\n\t\tconsole.log(\"sinboss\", priceArray);\n\t};\n\tconst updatePrice = async () => {\t\t\n\t\tmyContract!.methods\n\t\t\t.updatePrice()\n\t\t\t.send({\n\t\t\t\tfrom: publicAddress,\n\t\t\t\tgasPrice: await web3!.eth.getGasPrice(),\n\t\t\t\tgas: 100000,\n\t\t\t\tvalue: 5000000000000000\n\t\t\t}, function (error: null, res: any) {\n\t\t\t\tif (error != null) {\n\t\t\t\t\tconsole.log(error);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t});\n\t};\n\treturn (\n\t\t<div className=\"Profile\">\n\t\t\t<h1>Profile</h1>\n\t\t\t{/* <p>\n\t\t\t\tLogged in as <Blockies seed={publicAddress} />\n\t\t\t</p> */}\n\t\t\t<div>\n\t\t\t\tMy username is {username ? <pre>{username}</pre> : 'not set.'}{' '}\n\t\t\t\tMy publicAddress is <pre>{publicAddress}</pre>\n\t\t\t</div>\n\t\t\t<div>\n\t\t\t\t<label htmlFor=\"username\">Change username: </label>\n\t\t\t\t<input name=\"username\" onChange={handleChange} />\n\t\t\t\t<button disabled={loading} onClick={handleSubmit}>\n\t\t\t\t\tSubmit\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t\t<p>\n\t\t\t\t<button onClick={onLoggedOut}>Logout</button>\n\t\t\t</p>\n\t\t\t<h1>Dashboard for metrics from my Oracle.</h1>\n\t\t\t<div>\n\t\t\t\t<div>\n\t\t\t\t\tTest Network: Rinkeby\n\t\t\t\t\t</div>\n\t\t\t\t<div>\n\t\t\t\t\tOracle Contract Address: {ourOracle}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<button disabled={loadingGraph} onClick={updatePrice}>\n\t\t\t\tUpdate Price\n\t\t\t</button>\n\t\t\t<button disabled={loadingGraph} onClick={drawMetrics} style={{marginLeft:\"20px\"}}>\n\t\t\t\tRefresh\n\t\t\t</button>\n\t\t\t<p style={{marginBottom:\"10px\"}}>After calling oracle contract, we maybe wait for 1mins for new metrics info</p>\n\t\t\t<div>Total Updated Count: {totalUpdateCount}</div>\n\t\t\t<div>Current ETHUSDT: {currentETHUSDT}</div>\n\t\t\t\n\t\t\t<MetricTable tabledata={priceArray} />\t\t\t\n\t\t\t<div style={{ marginTop:\"10px\"}}></div>\t\n\t\t\t<Graph chartdata={priceArray} />\n\t\t</div>\n\t);\n};\n","import './App.css';\n\nimport React, { useEffect, useState } from 'react';\n\nimport { Login } from '../Login';\nimport { Profile } from '../Profile/Profile';\nimport { Auth } from '../types';\nimport logo from './eth.png';\n\nconst LS_KEY = 'login-with-metamask:auth';\n\ninterface State {\n\tauth?: Auth;\n}\n\nexport const App = (): JSX.Element => {\n\tconst [state, setState] = useState<State>({});\n\n\tuseEffect(() => {\n\t\t// Access token is stored in localstorage\n\t\tconst ls = window.localStorage.getItem(LS_KEY);\n\t\tconst auth = ls && JSON.parse(ls);\n\t\tsetState({ auth });\n\t}, []);\n\n\tconst handleLoggedIn = (auth: Auth) => {\n\t\tlocalStorage.setItem(LS_KEY, JSON.stringify(auth));\n\t\tsetState({ auth });\n\t};\n\n\tconst handleLoggedOut = () => {\n\t\tlocalStorage.removeItem(LS_KEY);\n\t\tsetState({ auth: undefined });\n\t};\n\n\tconst { auth } = state;\n\n\treturn (\n\t\t<div className=\"App\">\n\t\t\t<header className=\"App-header\">\n\t\t\t\t<img src={logo} className=\"App-logo\" alt=\"logo\" />\n\t\t\t\t<h1 className=\"App-title\">\n\t\t\t\t\tWelcome to SupraOracles Test Project\n\t\t\t\t</h1>\n\t\t\t</header>\n\t\t\t<div className=\"App-intro\">\n\t\t\t\t{auth ? (\n\t\t\t\t\t<Profile auth={auth} onLoggedOut={handleLoggedOut} />\n\t\t\t\t) : (\n\t\t\t\t\t<Login onLoggedIn={handleLoggedIn} />\n\t\t\t\t)}\n\t\t\t</div>\n\t\t</div>\n\t);\n};\n","export default \"data:image/png;base64,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\"","import './index.css';\n\nimport { config as dotEnvConfig } from 'dotenv';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport { App } from './App';\n\n// Load ENV variables\ndotEnvConfig({\n\tpath:\n\t\tprocess.env.NODE_ENV === 'production'\n\t\t\t? '.env.production'\n\t\t\t: '.env.development',\n});\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}